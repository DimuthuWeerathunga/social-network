generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model comment {
  id        BigInt         @id @default(autoincrement())
  user_id   BigInt
  post      post           @relation(fields: [post_id], references: [id], onDelete: Cascade)
  post_id   BigInt
  parent    comment?       @relation("nesting", fields: [parent_id], references: [id], onDelete: Cascade)
  parent_id BigInt?
  children  comment[]      @relation("nesting")
  content   String
  likes     comment_like[]
}

model post {
  id       BigInt    @id
  user_id  BigInt
  comments comment[]
}

model comment_like {
  user_id    BigInt
  comment    comment  @relation(fields: [comment_id], references: [id])
  comment_id BigInt
  liked_at   DateTime @default(now())

  @@id([user_id, comment_id])
}
